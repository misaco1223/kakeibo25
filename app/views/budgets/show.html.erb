<header class="mb-4 bg-neutral">
  <div class="navbar">
    <a href="#" class="btn btn-ghost text-xl">出金一覧</a>
    <p class="block">カテゴリー名: <%= @budget.category.name%></p>
  </div>
</header>

<div class="block mx-auto max-w-md">
  <div class="card bg-white shadow-lg rounded-lg p-6 border border-gray-300">
    <div class="card-body">
      <p class="text-gray-800 font-semibold mb-2">設定予算: <%=@budget.amount %>円</p>
      <p class="text-gray-800 font-semibold mb-2">支出合計: <%= @total_amount %>円</h1>
      <br>
      ------------------
      <div style="font-weight: bold; text-size:large;">
        <% if @remaining_amount > 0 %>
          <p style="color: black"><%= @remaining_amount %>円の <%= @status %>です</p>
        <% else %>
          <p style="color: red"><%= -@remaining_amount %>円の <%= @status %>です</p>
        <% end %>
      </div>
    </div>
  </div>
</div>

<div class="navbar">
  <%= link_to new_budget_payment_path(@budget), class: "btn btn-primary" do %>支出データを新規作成<% end %>
  <%= link_to money_file_path(@money_file), class: "btn" do %>この家計簿の予算一覧へ戻る<% end %>
</div>

<br>

<!-- 絞り込みフォーム -->
<div style="background-color: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1); max-width: 700px; width:100%; margin-left: 20px;">
<h1 style="padding:10px; font-weight: bold;">絞り込み欄</h1>
<%= form_with url: budget_path(@budget), method: :get, local: true do %>
  <div class="row mb-4" style="display: flex;">
    <!-- 日付フィルタ -->
    <div class="col-md-4" style="flex: 1; margin-right: 10px; max-width: 180px;">
      <%= label_tag :date_filter, "日付", style: "display: block; margin-bottom: 5px;" %>
      <%= select_tag :date_filter, options_for_select(
            [['選択してください', '']] + @payments.distinct.pluck(:date).map { |date| [date.strftime('%Y-%m-%d'), date.strftime('%Y-%m-%d')] },
            params[:date_filter]
          ), class: 'form-control', onchange: 'this.form.submit();', style: "width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #ccc;" %>
    </div>

    <!-- 支払い方法フィルタ -->
    <div class="col-md-4" style="flex: 1; margin-right: 10px; max-width: 180px;">
      <%= label_tag :pay_method_filter, "支払い方法", style: "display: block; margin-bottom: 5px;" %>
      <%= select_tag :pay_method_filter, options_for_select(
            [['選択してください', '']] + @pay_methods.map { |method| [method.name, method.id] },
            params[:pay_method_filter]
          ), class: 'form-control', onchange: 'this.form.submit();', style: "width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #ccc;" %>
    </div>

    <!-- 店舗フィルタ -->
    <div class="col-md-4" style="flex: 1; margin-right: 10px; max-width: 180px;">
      <%= label_tag :shop_filter, "店舗", style: "display: block; margin-bottom: 5px;" %>
      <%= select_tag :shop_filter, options_for_select(
            [['選択してください', '']] + @shops.map { |shop| [shop.name, shop.id] },
            params[:shop_filter]
          ), class: 'form-control', onchange: 'this.form.submit();', style: "width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #ccc;" %>
    </div>

    <div style="margin-top: 20px;"> 
      <%= link_to "絞り込み条件をクリア", budget_path(@budget), class: "btn" %>
    </div>
  </div>
<% end %>
</div>

<br><br>
<!-- Paymentのindexをレンダー -->
<%= render "payments/index" %>